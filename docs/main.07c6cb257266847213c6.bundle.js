(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{280:function(module,exports,__webpack_require__){__webpack_require__(281),__webpack_require__(426),module.exports=__webpack_require__(427)},345:function(module,exports){},427:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_svelte__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(277);module._StorybookPreserveDecorators=!0,Object(_storybook_svelte__WEBPACK_IMPORTED_MODULE_0__.configure)([__webpack_require__(611)],module)}.call(this,__webpack_require__(428)(module))},611:function(module,exports,__webpack_require__){var map={"./component.stories.js":634};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=611},634:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default})),__webpack_require__.d(__webpack_exports__,"ShowSong",(function(){return ShowSong})),__webpack_require__.d(__webpack_exports__,"Verse",(function(){return Verse})),__webpack_require__.d(__webpack_exports__,"Blank",(function(){return Blank})),__webpack_require__.d(__webpack_exports__,"fillColor",(function(){return fillColor})),__webpack_require__.d(__webpack_exports__,"fontWeightColor",(function(){return fontWeightColor}));__webpack_require__(612);var internal=__webpack_require__(7),ResizeObserver_es=__webpack_require__(278),svelte=__webpack_require__(279);__webpack_require__(19),__webpack_require__(28),__webpack_require__(29),__webpack_require__(59),__webpack_require__(39),__webpack_require__(23),__webpack_require__(108),__webpack_require__(40),__webpack_require__(156),__webpack_require__(87),__webpack_require__(48),__webpack_require__(18),__webpack_require__(30),__webpack_require__(31),__webpack_require__(32),__webpack_require__(169),__webpack_require__(33),__webpack_require__(68),__webpack_require__(276),__webpack_require__(60),__webpack_require__(66);function canvasGetBounds(canvas){var w=canvas.width,h=canvas.height,data=canvas.getContext("2d").getImageData(0,0,w,h).data,i=0,out={},offset=0;for(i=0;0===data[i<<2];)i++;if(void 0===data[i<<2])return null;for(out.y=Math.floor(i/w),i=data.length>>2;!data[i<<2];)i--;out.h=Math.ceil(i/w)-out.y,i=0;do{for(i=offset;0===data[i<<2];)i+=w;offset++}while(void 0===data[i<<2]);out.x=offset-1,offset=w-1,i=0;do{for(i=offset;0===data[i<<2];)i+=w;offset--}while(void 0===data[i<<2]);return out.w=offset+2-out.x,out}__webpack_require__(171),__webpack_require__(178);function splitWidestLine(verses,canvas){function widest(widest,item){return item.width>widest.width?item:widest}var widestLine=verses.reduce(widest).lines.reduce(widest),brokenLine=function splitLineEvenly(line,breaks,canvas){return function minDifference(permutations,canvas){var j,perm,lines,minDiff,outi,outlen,diff,min,max,len,line,i=0,ctx=canvas.getContext("2d");if(permutations.length){for(;perm=permutations[i];){for(lines=perm.split(/\n/g),j=1,max=min=ctx.measureText(lines[0]).width;line=lines[j];)(len=ctx.measureText(line).width)>max&&(max=len),len<min&&(min=len),j++;diff=max-min,(void 0===minDiff||diff<minDiff)&&(minDiff=diff,outlen=max,outi=i),i++}return{txt:permutations[outi],width:outlen,breaks:lines.length-1}}}(function linePermutations(line,breaks){for(var perm,j,join,word,words=line.split(/\s/g),permutes=function distributeBreaks(length,numBreaks){var allBreaks=[];return function recurse(i,out){var breaksLeft,j,copy=[];for(j=0;j<out.length;j++)copy.push(out[j]);0!==(breaksLeft=numBreaks-copy.length)?(copy.push(i),recurse(i+1,copy),length-1-i>breaksLeft&&(copy.pop(),recurse(i+1,copy))):allBreaks.push(copy)}(0,[]),allBreaks}(words.length,breaks),i=0,out=[];perm=permutes[i];){for(i++,join=words[0],j=0;word=words[j+1];)join+=(~perm.indexOf(j)?"\n":" ")+word,j++;out.push(join)}return out}(line,breaks),canvas)}(widestLine.line,widestLine.height,canvas);widestLine.width=brokenLine.width,widestLine.height=brokenLine.breaks+1,widestLine.brokenLine=brokenLine.txt}__webpack_require__(12),__webpack_require__(13);function augmentSong(metaSong,isSong){var vHeight,vWidth,height,h=0,w=0,numLines=0,augmented=JSON.parse(JSON.stringify(metaSong)),mFontHeight=augmented.fontMetrics.h,lineHeight=augmented.lineHeight,mLineHeight=augmented.fontMetrics.h*augmented.lineHeight,fontGap=(lineHeight-1)*mFontHeight;function max(line){line.width>w&&(w=line.width),line.width>vWidth&&(vWidth=line.width),vHeight+=line.height}return augmented.verses.forEach((function(verse){vHeight=0,vWidth=0,verse.lines.forEach(max),vHeight>h&&(h=vHeight),vWidth>w&&(w=vWidth),verse.height=vHeight,verse.width=vWidth,numLines+=vHeight})),augmented.pxHeight=isSong?(height=(augmented.verses.length-1)*augmented.verseGap*mFontHeight,augmented.verses.forEach((function(verse){var vh=verse.height;height+=vh*mLineHeight})),height-=fontGap):(h-1)*fontGap+h*mFontHeight,augmented.maxWidth=w,augmented.maxHeight=h,augmented.pnumLines=augmented.numLines,augmented.numLines=numLines,augmented.aspect=w/augmented.pxHeight,augmented}function SongContext(_ref){var lineHeight=_ref.lineHeight,fontHeight=_ref.fontHeight,_ref$fontName=_ref.fontName,fontName=void 0===_ref$fontName?fontName||"Helvetica, Arial, Sans-Serif":_ref$fontName,_ref$verseGap=_ref.verseGap,verseGap=void 0===_ref$verseGap?lineHeight:_ref$verseGap,fontWeight=_ref.fontWeight,_ref$fillStyle=_ref.fillStyle,fillStyle=void 0===_ref$fillStyle?"#fff":_ref$fillStyle,canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),fontStr=ctx.font=(void 0===fontWeight?"":fontWeight+" ")+fontHeight+"px "+fontName,fontMetrics=function measureString(text,canvas,fontSize,font){var b,ctx=canvas.getContext("2d");return fontSize=fontSize||15,ctx.font=font,canvas.width=ctx.measureText(text).width,canvas.height=1.4*fontSize,ctx.font=font,ctx.fillStyle="#fff",ctx.fillText(text,0,fontSize),(b=canvasGetBounds(canvas)).descent=b.y+b.h-fontSize,b.ascent=b.h-b.descent,ctx.fillStyle="rgba(0,0,0,0.5)",ctx.fillRect(b.x,b.y,b.w,b.h),canvas.style.position="absolute",canvas.style.top=0,canvas.style.background="#ff0",b}("Hygpqil",canvas,fontHeight,fontStr);function clone(obj){return JSON.parse(JSON.stringify(obj))}function setSong(song){function measure(line){return{line:line,brokenLine:line,height:1,width:ctx.measureText(line).width}}return{verseGap:verseGap,fontMetrics:fontMetrics,fontHeight:fontHeight,fontName:fontName,lineHeight:lineHeight,fontWeight:fontWeight,fillStyle:fillStyle,verses:song.verses.map((function(verse){return{lines:verse.lines.map(measure)}}))}}function log(song){song.verses.map((function(verse){return verse.lines.map((function(line){return line.brokenLine})).join("\n")})).join("\n\n")}return ctx.font=fontStr,{setSong:setSong,getPlausibleSongLayouts:function(song){var augmented=augmentSong(setSong(song),!0),plausible=[];return function tick(augmented){var maxHeight;maxHeight=(augmented=clone(augmented)).maxHeight,augmented.pnumLines!==augmented.numLines&&1e3!==maxHeight&&(plausible.push(clone(augmented)),splitWidestLine(augmented.verses,canvas),tick(augmented=augmentSong(augmented,!0)))}(augmented),plausible},getPlausibleVerseLayouts:function(song){var augmented=augmentSong(setSong(song),!1),plausible=[];return function tick(augmented){var shortVerses,longVerses,longerMaxWidth,shorterMaxWidth,maxHeight;function longs(verse){return verse.height>=maxHeight||verse.width<=augmented.maxWidth}function maxWidth(a,b){return Math.max(a.width,b.width)}if(augmented=clone(augmented),maxHeight=augmented.maxHeight,shortVerses=augmented.verses.filter((function(verse){return!longs(verse)})),longerMaxWidth=(longVerses=augmented.verses.filter(longs)).reduce(maxWidth,longVerses[0].width),shortVerses.length&&(shorterMaxWidth=shortVerses.reduce(maxWidth,longVerses[0].width)),augmented.pnumLines!==augmented.numLines){if(!shortVerses.length||longerMaxWidth>=shorterMaxWidth){if(50===maxHeight)return;plausible.push(clone(augmented)),splitWidestLine(longVerses,canvas)}else splitWidestLine(shortVerses,canvas);tick(augmented=augmentSong(augmented,!1))}}(augmented),plausible},findBestFit:function(plausibleLayouts,w,h){for(var m,aspect=w/h,out=plausibleLayouts[0],margin=Math.abs(aspect-plausibleLayouts[0].aspect),i=1;i<plausibleLayouts.length;i++)(m=Math.abs(aspect-plausibleLayouts[i].aspect))<margin&&(margin=m,out=plausibleLayouts[i]);return log(out),out},log:log}}__webpack_require__(20),__webpack_require__(625),__webpack_require__(627),__webpack_require__(86),__webpack_require__(628);function _defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}var Song=function(){function Song(text){!function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Song);var verses,self=this;text=text.replace(/\r/g,""),["artist","title","id"].forEach((function extractTag(tag){var tagEx=new RegExp("^"+tag+":\\s*(.*)$","m"),tagDel=new RegExp("^"+tag+":\\s*(.*)[\n]?","m"),val=text.match(tagEx);null!==(val=val&&val[1]&&val[1].trim()||null)&&(self[tag]=val),text=text.replace(tagDel,"")})),"string"==typeof this.id&&(this.id=parseInt(this.id,10)),verses=(verses=(verses=text.trim().split("\n\n")).map((function(verse){return{lines:verse.split("\n")}}))).filter((function(verse){return!(1===verse.lines.length&&""===verse.lines[0])})),this.verses=verses}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(Song,[{key:"getTitle",value:function getTitle(){return void 0!==this.title?this.title:this.verses[0]&&this.verses[0].lines.length&&""!==this.verses[0].lines[0]&&this.verses[0].lines[0]||void 0}},{key:"toString",value:function toString(){var _this=this;return(["title","artist","id "].filter((function(tag){return void 0!==_this[tag]})).map((function(tag){return tag+": "+_this[tag]})).join("\n")+"\n\n"+this.verses.map((function(verse){return verse.lines.join("\n")})).join("\n\n")).trim()}},{key:"wholeSongText",value:function wholeSongText(){return this.verses.map((function(verse){return verse.lines.join("\n")})).join("\n\n")}},{key:"toLinesOnly",value:function toLinesOnly(){var lines=[];return this.verses.forEach((function(verse){return lines.concat(verse)})),lines}},{key:"maxLinesInVerse",value:function maxLinesInVerse(){var max=0;return this.verses.forEach((function(verse){return max=Math.max(max,verse.length)})),max}}]),Song}();function transform_defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}var Transform=function(){function Transform(matrix){!function transform_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Transform),matrix?this.m=matrix:this.reset()}return function transform_createClass(Constructor,protoProps,staticProps){return protoProps&&transform_defineProperties(Constructor.prototype,protoProps),staticProps&&transform_defineProperties(Constructor,staticProps),Constructor}(Transform,[{key:"reset",value:function reset(){this.m=[1,0,0,1,0,0]}},{key:"multiply",value:function multiply(matrix){var m11=this.m[0]*matrix.m[0]+this.m[2]*matrix.m[1],m12=this.m[1]*matrix.m[0]+this.m[3]*matrix.m[1],m21=this.m[0]*matrix.m[2]+this.m[2]*matrix.m[3],m22=this.m[1]*matrix.m[2]+this.m[3]*matrix.m[3],dx=this.m[0]*matrix.m[4]+this.m[2]*matrix.m[5]+this.m[4],dy=this.m[1]*matrix.m[4]+this.m[3]*matrix.m[5]+this.m[5];this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22,this.m[4]=dx,this.m[5]=dy}},{key:"getInverseTransform",value:function getInverseTransform(){var d=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]);return new Transform([this.m[3]*d,-this.m[1]*d,-this.m[2]*d,this.m[0]*d,d*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),d*(this.m[1]*this.m[4]-this.m[0]*this.m[5])])}},{key:"rotate",value:function rotate(rad){var c=Math.cos(rad),s=Math.sin(rad),m11=this.m[0]*c+this.m[2]*s,m12=this.m[1]*c+this.m[3]*s,m21=this.m[0]*-s+this.m[2]*c,m22=this.m[1]*-s+this.m[3]*c;this.m[0]=m11,this.m[1]=m12,this.m[2]=m21,this.m[3]=m22}},{key:"skewY",value:function skewY(rad){var r=Math.tan(rad),m11=this.m[0]+this.m[2]*r,m12=this.m[1]+this.m[3]*r;this.m[0]=m11,this.m[1]=m12}},{key:"skewX",value:function skewX(rad){var r=Math.tan(rad),m21=this.m[0]*r+this.m[2],m22=this.m[1]*r+this.m[3];this.m[2]=m21,this.m[3]=m22}},{key:"translate",value:function translate(x,y){this.m[4]+=this.m[0]*x+this.m[2]*y,this.m[5]+=this.m[1]*x+this.m[3]*y}},{key:"scale",value:function scale(sx,sy){this.m[0]*=sx,this.m[1]*=sx,this.m[2]*=sy,this.m[3]*=sy}},{key:"transformPoint",value:function transformPoint(px,py){var x=px,y=py;return{x:px=x*this.m[0]+y*this.m[2]+this.m[4],y:py=x*this.m[1]+y*this.m[3]+this.m[5]}}}]),Transform}();function roughBoundsToTrueBounds(drawCallback,w,h,bounds1,bounds2){var ctx,transInv,trueBounds,aspect=w/h,songAspect=bounds1.w/bounds1.h,canvas=document.createElement("canvas"),sf=aspect>songAspect?h/bounds1.h:w/bounds1.w,trans=new Transform;return canvas.setAttribute("id","canvas-super"),bounds2?(sf=aspect>bounds2.w/bounds2.h?h/(bounds2.h/(1.1*sf)):w/(bounds2.w/(1.1*sf)),canvas.width=Math.ceil(sf*bounds1.w)+8,canvas.height=Math.ceil(sf*bounds1.h)+8):(sf*=1.1,canvas.width=Math.ceil(sf*bounds1.w)+8,canvas.height=Math.ceil(sf*bounds1.h)+8),(ctx=canvas.getContext("2d")).fillStyle="#fff",ctx.save(),trans.scale(sf,sf),trans.translate(4/sf,4/sf),transInv=trans.getInverseTransform(),ctx.setTransform.apply(ctx,trans.m),drawCallback(ctx),bounds2?(bounds2=canvasGetBounds(canvas),(trueBounds=transInv.transformPoint(bounds2.x,bounds2.y)).w=bounds2.w/sf,trueBounds.h=bounds2.h/sf,trueBounds.sf=sf,trueBounds):roughBoundsToTrueBounds(drawCallback,w,h,bounds1,bounds2=canvasGetBounds(canvas))}function drawVerse(_ref){var song=_ref.song,verse=_ref.verse,ctx=_ref.ctx,x=_ref.x,y=_ref.y,_ref$isStroke=_ref.isStroke,isStroke=void 0!==_ref$isStroke&&_ref$isStroke,lineNum=0,mLineHeight=song.fontMetrics.h*song.lineHeight;ctx.font=(void 0===song.fontWeight?"":song.fontWeight+" ")+song.fontHeight+"px "+song.fontName,song.fillStyle&&(ctx.fillStyle=song.fillStyle,ctx.strokeStyle=song.fillStyle),song.verses[verse].lines.forEach((function(line){line.brokenLine.split("\n").forEach((function(fragment){isStroke?ctx.strokeText(fragment,x,y+song.fontMetrics.ascent+lineNum*mLineHeight):ctx.fillText(fragment,x,y+song.fontMetrics.ascent+lineNum*mLineHeight),lineNum++}))}))}function drawSong(_ref){var song=_ref.song,ctx=_ref.ctx,x=_ref.x,y=_ref.y,isStroke=_ref.isStroke,mLineHeight=song.fontMetrics.h*song.lineHeight;song.verses.forEach((function(verse,i){drawVerse({song:song,verse:i,ctx:ctx,x:x,y:y,isStroke:isStroke}),y+=song.verseGap*song.fontMetrics.h+mLineHeight*verse.height}))}__webpack_require__(630),__webpack_require__(168),__webpack_require__(632),__webpack_require__(633),__webpack_require__(41);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var defaults={skewX:0,skewY:0,rotate:0,scaleX:1,scaleY:1,handleX:.5,handleY:.5,posX:0,posY:0,fill:"#ccc"};var valiant="He who would valiant be 'gainst all disaster,\nLet him in constancy follow the Master.\nThere's no discouragement shall make him once relent\nHis first avowed intent to be a pilgrim.\n\nWho so beset him round with dismal stories\nDo but themselves confoundÂhis strength the more is.\nNo foes shall stay his might; though he with giants fight,\nHe will make good his right to be a pilgrim.\n\nSince, Lord, Thou dost defend us with Thy Spirit,\nWe know we at the end, shall life inherit.\nThen fancies flee away! I'll fear not what men say,\nI'll labor night and day to be a pilgrim.\n";function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(arr)))return;var _arr=[],_n=!0,_d=!1,_e=void 0;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function song_display_defineProperties(target,props){for(var descriptor,i=0;i<props.length;i++)(descriptor=props[i]).enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}var song_display_SongDisplay=function(){function SongDisplay(_ref){var lineHeight=_ref.lineHeight,fontHeight=_ref.fontHeight,fontFamily=_ref.fontFamily,verseGap=_ref.verseGap,fontWeight=_ref.fontWeight,fillStyle=_ref.fillStyle;!function song_display_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SongDisplay);var _fillStyle=fillStyle;if(/#[0-9a-fA-F]{3}$/.test(fillStyle)){var _fillStyle2=_slicedToArray(fillStyle,4),r=(_fillStyle2[0],_fillStyle2[1]),g=_fillStyle2[2],b=_fillStyle2[3];_fillStyle="#"+r+r+g+g+b+b}_fillStyle=/#[0-9a-fA-F]{6}$/.test(_fillStyle)?_fillStyle.replace("#00","#01"):"#fff",this.render=this.render.bind(this),this.isBlank=!0,this.mode="SHOW_VERSE",this.verseId=0,this.song=new Song(valiant),this.songCtx=new SongContext({lineHeight:lineHeight||1.4,fontHeight:fontHeight||25,fontName:fontFamily||'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',verseGap:verseGap||.75,fontWeight:fontWeight,fillStyle:_fillStyle}),this.verseLayouts=this.songCtx.getPlausibleVerseLayouts(this.song),this.songLayouts=this.songCtx.getPlausibleSongLayouts(this.song)}return function song_display_createClass(Constructor,protoProps,staticProps){return protoProps&&song_display_defineProperties(Constructor.prototype,protoProps),staticProps&&song_display_defineProperties(Constructor,staticProps),Constructor}(SongDisplay,[{key:"setState",value:function setState(_ref2){var song=_ref2.song,isBlank=_ref2.isBlank,verseId=_ref2.verseId,mode=_ref2.mode;song!==this.song&&(this.verseLayouts=this.songCtx.getPlausibleVerseLayouts(song),this.songLayouts=this.songCtx.getPlausibleSongLayouts(song)),void 0!==isBlank&&(this.isBlank=isBlank),void 0!==verseId&&(this.verseId=verseId),void 0!==mode&&(this.mode=mode)}},{key:"render",value:function render(canvas){var _this=this,ctx=canvas.getContext("2d"),width=canvas.width,height=canvas.height;if(ctx.fillColor="#000",ctx.fillRect(0,0,width,height),!this.isBlank){var renderer="SHOW_VERSE"===this.mode?function verseRender(){var bestfit=_this.songCtx.findBestFit(_this.verseLayouts,width,height);return{metrics:function drawVersesToGetBounds(_ref){var song=_ref.song,canvasWidth=_ref.canvasWidth,canvasHeight=_ref.canvasHeight,_ref$isStroke=_ref.isStroke,isStroke=void 0!==_ref$isStroke&&_ref$isStroke;return roughBoundsToTrueBounds((function(ctx){song.verses.forEach((function(verse,i){drawVerse({song:song,verse:i,ctx:ctx,x:0,y:0,isStroke:isStroke})}))}),canvasWidth,canvasHeight,{x:0,y:0,h:song.pxHeight,w:song.maxWidth})}({song:bestfit,canvasWidth:width,canvasHeight:height}),renderCallback:function renderCallback(ctx,offx,offy){drawVerse({song:bestfit,ctx:ctx,x:offx,y:offy,verse:_this.verseId})}}}():function songRender(){var bestfit=_this.songCtx.findBestFit(_this.songLayouts,width,height);return{metrics:function drawSongToGetBounds(_ref){var song=_ref.song,canvasWidth=_ref.canvasWidth,canvasHeight=_ref.canvasHeight,_ref$isStroke=_ref.isStroke,isStroke=void 0!==_ref$isStroke&&_ref$isStroke;return roughBoundsToTrueBounds((function(ctx){drawSong({song:song,ctx:ctx,x:0,y:0,isStroke:isStroke})}),canvasWidth,canvasHeight,{x:0,y:0,h:song.pxHeight,w:song.maxWidth})}({song:bestfit,canvasWidth:width,canvasHeight:height}),renderCallback:function renderCallback(ctx,offx,offy){drawSong({song:bestfit,ctx:ctx,x:offx,y:offy})}}}();!function renderAffineText(ctx,metrics,renderCallback,conf){ctx.save(),conf=_objectSpread(_objectSpread({},defaults),conf);var trans,inverse,verseTrans=new Transform;verseTrans.scale(metrics.sf,metrics.sf),verseTrans.rotate(conf.rotate),verseTrans.scale(conf.scaleX,conf.scaleY),verseTrans.translate(-metrics.w*conf.handleX,-metrics.h*conf.handleY),verseTrans.skewX(conf.skewX),verseTrans.skewY(conf.skewY),inverse=verseTrans.getInverseTransform(),verseTrans.transformPoint(metrics.x,metrics.y),trans=inverse.transformPoint(conf.posX,conf.posY),verseTrans.translate(trans.x,trans.y),verseTrans.translate(-metrics.w*conf.handleX,-metrics.h*conf.handleY),ctx.fillStyle=conf.fill,ctx.strokeStyle=conf.fill,ctx.setTransform.apply(ctx,verseTrans.m),renderCallback(ctx,-metrics.x,-metrics.y),ctx.restore()}(ctx,renderer.metrics,renderer.renderCallback,{fill:"#fff",posX:width/2,posY:height/2,scaleX:1,scaleY:1})}}}]),SongDisplay}();function create_fragment(ctx){let canvas_1;return{c(){canvas_1=Object(internal.element)("canvas"),Object(internal.attr)(canvas_1,"style",ctx[0])},m(target,anchor){Object(internal.insert)(target,canvas_1,anchor),ctx[12](canvas_1)},p(ctx,[dirty]){1&dirty&&Object(internal.attr)(canvas_1,"style",ctx[0])},i:internal.noop,o:internal.noop,d(detaching){detaching&&Object(internal.detach)(canvas_1),ctx[12](null)}}}function instance($$self,$$props,$$invalidate){let canvas,song,ratio=window.devicePixelRatio||1,{text:text=valiant}=$$props,{blank:blank=!1}=$$props,{verseIndex:verseIndex=0}=$$props,{showSong:showSong=!1}=$$props,{style:style="width: 100%; height: 100%;"}=$$props,{fontSize:fontSize=25}=$$props,{verseGap:verseGap=.75}=$$props,{lineHeight:lineHeight=1.4}=$$props,{fontFamily:fontFamily='-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"'}=$$props,{fontWeight:fontWeight="400"}=$$props,{fillStyle:fillStyle="#fff"}=$$props;const songDisplay=new song_display_SongDisplay({fontSize:fontSize,lineHeight:lineHeight,fontFamily:fontFamily,verseGap:verseGap,fontWeight:fontWeight,fillStyle:fillStyle});function _onResize({width:width,height:height}){$$invalidate(1,canvas.width=width*ratio,canvas),$$invalidate(1,canvas.height=height*ratio,canvas)}return Object(svelte.a)(()=>{let clear,now=0;const resizeObserver=new ResizeObserver_es.a(entries=>{for(let entry of entries)performance.now()-now>100?(clearTimeout(clear),_onResize(entry.contentRect),now=performance.now()):(clearTimeout(clear),clear=setTimeout(()=>_onResize(entry.contentRect),100))});return resizeObserver.observe(canvas),()=>{clearTimeout(clear),resizeObserver.unobserve(canvas)}}),$$self.$set=$$props=>{"text"in $$props&&$$invalidate(2,text=$$props.text),"blank"in $$props&&$$invalidate(3,blank=$$props.blank),"verseIndex"in $$props&&$$invalidate(4,verseIndex=$$props.verseIndex),"showSong"in $$props&&$$invalidate(5,showSong=$$props.showSong),"style"in $$props&&$$invalidate(0,style=$$props.style),"fontSize"in $$props&&$$invalidate(6,fontSize=$$props.fontSize),"verseGap"in $$props&&$$invalidate(7,verseGap=$$props.verseGap),"lineHeight"in $$props&&$$invalidate(8,lineHeight=$$props.lineHeight),"fontFamily"in $$props&&$$invalidate(9,fontFamily=$$props.fontFamily),"fontWeight"in $$props&&$$invalidate(10,fontWeight=$$props.fontWeight),"fillStyle"in $$props&&$$invalidate(11,fillStyle=$$props.fillStyle)},$$self.$$.update=()=>{4&$$self.$$.dirty&&$$invalidate(13,song=new Song(text)),8250&$$self.$$.dirty&&song&&(songDisplay.setState({song:song,isBlank:blank,verseId:verseIndex,mode:showSong?"SHOW_SONG":"SHOW_VERSE"}),canvas&&songDisplay.render(canvas))},[style,canvas,text,blank,verseIndex,showSong,fontSize,verseGap,lineHeight,fontFamily,fontWeight,fillStyle,function canvas_1_binding($$value){internal.binding_callbacks[$$value?"unshift":"push"](()=>{canvas=$$value,$$invalidate(1,canvas)})}]}class SongDisplay_svelte_SongDisplay_1 extends internal.SvelteComponent{constructor(options){super(),Object(internal.init)(this,options,instance,create_fragment,internal.safe_not_equal,{text:2,blank:3,verseIndex:4,showSong:5,style:0,fontSize:6,verseGap:7,lineHeight:8,fontFamily:9,fontWeight:10,fillStyle:11})}}var SongDisplay_svelte=SongDisplay_svelte_SongDisplay_1,Default=(__webpack_exports__.default={title:"Component",component:SongDisplay_svelte},function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto"}}}),ShowSong=function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto",showSong:!0,text:"Stand up, stand up for Jesus,\nYe soldiers of the cross;\nLift high his royal banner,\nIt must not suffer loss.\nFrom victory unto victory\nHis army shall he lead,\nTill every foe is vanquished,\nAnd Christ is Lord indeed.\n\nStand up, stand up for Jesus,\nStand in his strength alone;\nThe arm of flesh will fail you,\nYe dare not trust your own.\nPut on the gospel armor,\nEach piece put on with prayer;\nWhere duty calls or danger,\nBe never wanting there.\n\nStand up, stand up for Jesus,\nThe strife will not be long;\nThis day the noise of battle,\nThe next the victor's song.\nTo those who vanquish evil\nA crown of life shall be;\nThey with the King of Glory\nShall reign eternally."}}},Verse=function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto",verseId:1,text:"Stand up, stand up for Jesus,\nYe soldiers of the cross;\nLift high his royal banner,\nIt must not suffer loss.\nFrom victory unto victory\nHis army shall he lead,\nTill every foe is vanquished,\nAnd Christ is Lord indeed.\n\nStand up, stand up for Jesus,\nStand in his strength alone;\nThe arm of flesh will fail you,\nYe dare not trust your own.\nPut on the gospel armor,\nEach piece put on with prayer;\nWhere duty calls or danger,\nBe never wanting there.\n\nStand up, stand up for Jesus,\nThe strife will not be long;\nThis day the noise of battle,\nThe next the victor's song.\nTo those who vanquish evil\nA crown of life shall be;\nThey with the King of Glory\nShall reign eternally."}}},Blank=function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto",blank:!0,verseId:1,text:"Stand up, stand up for Jesus,\nYe soldiers of the cross;\nLift high his royal banner,\nIt must not suffer loss.\nFrom victory unto victory\nHis army shall he lead,\nTill every foe is vanquished,\nAnd Christ is Lord indeed.\n\nStand up, stand up for Jesus,\nStand in his strength alone;\nThe arm of flesh will fail you,\nYe dare not trust your own.\nPut on the gospel armor,\nEach piece put on with prayer;\nWhere duty calls or danger,\nBe never wanting there.\n\nStand up, stand up for Jesus,\nThe strife will not be long;\nThis day the noise of battle,\nThe next the victor's song.\nTo those who vanquish evil\nA crown of life shall be;\nThey with the King of Glory\nShall reign eternally."}}},fillColor=function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto",verseId:1,fillStyle:"#3cf",text:"Stand up, stand up for Jesus,\nYe soldiers of the cross;\nLift high his royal banner,\nIt must not suffer loss.\nFrom victory unto victory\nHis army shall he lead,\nTill every foe is vanquished,\nAnd Christ is Lord indeed.\n\nStand up, stand up for Jesus,\nStand in his strength alone;\nThe arm of flesh will fail you,\nYe dare not trust your own.\nPut on the gospel armor,\nEach piece put on with prayer;\nWhere duty calls or danger,\nBe never wanting there.\n\nStand up, stand up for Jesus,\nThe strife will not be long;\nThis day the noise of battle,\nThe next the victor's song.\nTo those who vanquish evil\nA crown of life shall be;\nThey with the King of Glory\nShall reign eternally."}}},fontWeightColor=function(){return{Component:SongDisplay_svelte,props:{style:"width: 60%; height: 360px; resize: both; overflow: auto",verseId:1,fontWeight:"italic bold",text:"Stand up, stand up for Jesus,\nYe soldiers of the cross;\nLift high his royal banner,\nIt must not suffer loss.\nFrom victory unto victory\nHis army shall he lead,\nTill every foe is vanquished,\nAnd Christ is Lord indeed.\n\nStand up, stand up for Jesus,\nStand in his strength alone;\nThe arm of flesh will fail you,\nYe dare not trust your own.\nPut on the gospel armor,\nEach piece put on with prayer;\nWhere duty calls or danger,\nBe never wanting there.\n\nStand up, stand up for Jesus,\nThe strife will not be long;\nThis day the noise of battle,\nThe next the victor's song.\nTo those who vanquish evil\nA crown of life shall be;\nThey with the King of Glory\nShall reign eternally."}}}}},[[280,1,2]]]);
//# sourceMappingURL=main.07c6cb257266847213c6.bundle.js.map